SELECT * FROM processo_vwAprovaFinCab

USE[P12_PRODUCAO]

SELECT
'01'+E2_FILIAL Cod_Empresa,
E2_FILIAL+E2_PREFIXO+E2_NUM+E2_PARCELA+E2_TIPO+E2_FORNECE+E2_LOJA Codigo,
'FI ' Tipo,
CONVERT(DATE,E2_EMIS1) Emissao,
E2_FORNECE+E2_LOJA Cod_Loja,
E2_NOMFOR Bene,
CAST(E2_VALOR AS decimal(18,2)) AS Valor,
E2_SALDO,
CONVERT(DATE,E2_VENCREA) Vencimento,
E2_HIST Observacao,
E2_NATUREZ Natureza,
E2_FILIAL,
E2_PREFIXO,
E2_NUM,
E2_PARCELA,
E2_TIPO,
E2_FORNECE,
E2_LOJA,
E2_XPRTLIB,
E2_STATLIB,
E2_DATALIB
FROM P12_PRODUCAO..SE2010 SE2
WHERE E2_SALDO > 0
AND SE2.D_E_L_E_T_=' '
AND E2_DATALIB=''
AND E2_XPRTLIB='1'

UNION ALL

SELECT
'02'+E2_FILIAL Cod_Empresa,
E2_FILIAL+E2_PREFIXO+E2_NUM+E2_PARCELA+E2_TIPO+E2_FORNECE+E2_LOJA Codigo,
'FI ' Tipo,
CONVERT(DATE,E2_EMIS1) Emissao,
E2_FORNECE+E2_LOJA Cod_Loja,
E2_NOMFOR Bene,
CAST(E2_VALOR AS decimal(18,2)) AS Valor,
E2_SALDO,
CONVERT(DATE,E2_VENCREA) Vencimento,
E2_HIST Observacao,
E2_NATUREZ Natureza,
E2_FILIAL,
E2_PREFIXO,
E2_NUM,
E2_PARCELA,
E2_TIPO,
E2_FORNECE,
E2_LOJA,
E2_XPRTLIB,
E2_STATLIB,
E2_DATALIB
FROM P12_PRODUCAO..SE2020 SE2
WHERE E2_SALDO > 0
AND SE2.D_E_L_E_T_=' '
AND E2_DATALIB=''
AND E2_XPRTLIB='1'

UNION ALL

SELECT
'03'+E2_FILIAL Cod_Empresa,
E2_FILIAL+E2_PREFIXO+E2_NUM+E2_PARCELA+E2_TIPO+E2_FORNECE+E2_LOJA Codigo,
'FI ' Tipo,
CONVERT(DATE,E2_EMIS1) Emissao,
E2_FORNECE+E2_LOJA Cod_Loja,
E2_NOMFOR Bene,
CAST(E2_VALOR AS decimal(18,2)) AS Valor,
E2_SALDO,
CONVERT(DATE,E2_VENCREA) Vencimento,
E2_HIST Observacao,
E2_NATUREZ Natureza,
E2_FILIAL,
E2_PREFIXO,
E2_NUM,
E2_PARCELA,
E2_TIPO,
E2_FORNECE,
E2_LOJA,
E2_XPRTLIB,
E2_STATLIB,
E2_DATALIB,
SE2.R_E_C_N_O_
FROM P12_PRODUCAO..SE2030 SE2
WHERE E2_SALDO > 0
AND SE2.D_E_L_E_T_=' '
AND E2_DATALIB=''
AND E2_XPRTLIB='1'

SELECT * FROM SE2030 WHERE R_E_C_N_O_=106
SELECT * FROM SE2030 WHERE R_E_C_N_O_=107


SELECT * FROM SE2030 WHERE E2_NUM='NUMTST001'